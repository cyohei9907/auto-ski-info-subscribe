# X.com çˆ¬è™«è§£å†³æ–¹æ¡ˆæ€»ç»“

## é—®é¢˜èƒŒæ™¯

**åŸå§‹é—®é¢˜**: ç‚¹å‡»"æœ€æ–° 10 æ¡"æŒ‰é’®è¿”å› 0 æ¡æ–°æ¨æ–‡ï¼Œå°½ç®¡ç”¨æˆ·ç¡®è®¤@skiinfomation æœ‰ 2025-11-06 çš„æœ€æ–°æ¨æ–‡ã€‚

**æ ¹æœ¬åŸå› **: X.com åœ¨æœªç™»å½•ï¼ˆæ¸¸å®¢ï¼‰çŠ¶æ€ä¸‹çš„é™åˆ¶ï¼š

- åªæ˜¾ç¤º 4-6 æ¡å›ºå®š/ç½®é¡¶æ¨æ–‡
- æ— æ³•æ»šåŠ¨åŠ è½½æ›´å¤šæ¨æ–‡
- æ— æ³•è®¿é—®å®Œæ•´æ—¶é—´çº¿
- æœ€æ–°æ¨æ–‡ä¸å¯è§

## è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ç™»å½•è®¤è¯

### âœ… æ¨èæ–¹æ¡ˆï¼šè®¤è¯çˆ¬è™«ï¼ˆå·²å®ç°ï¼‰

ä½¿ç”¨ä½ çš„ X.com è´¦å·ç™»å½•è¿›è¡Œçˆ¬è™«ï¼Œä¸€æ¬¡ç™»å½•é•¿æœŸä½¿ç”¨ã€‚

**ä¼˜åŠ¿**ï¼š

- âœ… è®¿é—®å®Œæ•´æ—¶é—´çº¿
- âœ… è·å–æœ€æ–°æ¨æ–‡ï¼ˆåŒ…æ‹¬ä»Šå¤©çš„ï¼‰
- âœ… æ”¯æŒæ»šåŠ¨åŠ è½½ï¼ˆ20-100+æ¡æ¨æ–‡ï¼‰
- âœ… ç¨³å®šå¯é ï¼Œä¸æ˜“è¢«å°
- âœ… ä¸€æ¬¡ç™»å½•ï¼Œcookies è‡ªåŠ¨ä¿å­˜é‡ç”¨

**å®æ–½æ­¥éª¤**ï¼š

1. **è¿è¡Œè®¤è¯è®¾ç½®**ï¼ˆåœ¨ Windows æœ¬åœ°ï¼‰ï¼š
   ```bash
   cd backend
   python local_setup_auth.py
   ```
2. **æ‰‹åŠ¨ç™»å½• X.com**ï¼š

   - æµè§ˆå™¨ä¼šæ‰“å¼€
   - è¾“å…¥ä½ çš„è´¦å·å¯†ç ç™»å½•
   - ç­‰å¾…é¡µé¢åŠ è½½å®Œæˆ
   - å›åˆ°ç»ˆç«¯æŒ‰ Enter

3. **å¯ç”¨è®¤è¯çˆ¬è™«**ï¼š
   ç¼–è¾‘ `docker-compose.yml`ï¼š

   ```yaml
   environment:
     USE_AUTHENTICATED_SCRAPER: "True"
   ```

4. **é‡å¯æœåŠ¡**ï¼š

   ```bash
   docker-compose restart
   ```

5. **æµ‹è¯•**ï¼š
   ```bash
   docker-compose exec backend python test_authenticated_scraper.py
   ```

**æ–‡ä»¶è¯´æ˜**ï¼š

- `backend/data/x_cookies.json` - ä¿å­˜çš„ç™»å½• cookiesï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
- `backend/x_monitor/authenticated_scraper.py` - è®¤è¯çˆ¬è™«å®ç°
- `backend/local_setup_auth.py` - Windows æœ¬åœ°è®¤è¯è®¾ç½®è„šæœ¬
- `AUTHENTICATED_SCRAPER_GUIDE.md` - è¯¦ç»†ä½¿ç”¨æŒ‡å—

---

## å…¶ä»–æ–¹æ¡ˆï¼ˆä¾›å‚è€ƒï¼‰

### æ–¹æ¡ˆ 2: Twitter APIï¼ˆéœ€ä»˜è´¹ï¼‰

**ä¼˜ç‚¹**ï¼šå®˜æ–¹æ”¯æŒï¼Œç¨³å®šå¯é 
**ç¼ºç‚¹**ï¼šéœ€è¦ä»˜è´¹ï¼ˆBasic å¥—é¤$100/æœˆï¼‰
**å®æ–½**ï¼šç”³è¯· API å¯†é’¥ï¼Œé…ç½®åˆ°ç¯å¢ƒå˜é‡

### æ–¹æ¡ˆ 3: Nitter ä»£ç†ï¼ˆä¸æ¨èï¼‰

**ä¼˜ç‚¹**ï¼šæ— éœ€ç™»å½•
**ç¼ºç‚¹**ï¼šNitter å®ä¾‹ä¸ç¨³å®šï¼Œç»å¸¸å¤±æ•ˆ
**çŠ¶æ€**ï¼šå·²æµ‹è¯•ï¼Œå½“å‰ä¸»è¦å®ä¾‹å‡ä¸å¯ç”¨

### æ–¹æ¡ˆ 4: æ¸¸å®¢æ¨¡å¼ï¼ˆå½“å‰é»˜è®¤ï¼‰

**ä¼˜ç‚¹**ï¼šæ— éœ€é…ç½®
**ç¼ºç‚¹**ï¼šä»…èƒ½è·å– 4-6 æ¡ç½®é¡¶æ¨æ–‡ï¼Œæ— æ³•è·å–æœ€æ–°æ¨æ–‡
**çŠ¶æ€**ï¼šå·²å®ç°ï¼Œä½†åŠŸèƒ½å—é™

---

## å½“å‰å®ç°çŠ¶æ€

### âœ… å·²å®ŒæˆåŠŸèƒ½

1. **è®¤è¯çˆ¬è™«** (`authenticated_scraper.py`)

   - æ”¯æŒ cookies ä¿å­˜å’ŒåŠ è½½
   - è‡ªåŠ¨ä½¿ç”¨å·²ç™»å½• session
   - æ»šåŠ¨åŠ è½½å®Œæ•´æ—¶é—´çº¿

2. **æ¸¸å®¢çˆ¬è™«** (`services.py` ä¸­çš„ `XScraperClient`)

   - åŸºç¡€çˆ¬è™«åŠŸèƒ½
   - å—é™äº 4-6 æ¡æ¨æ–‡

3. **æ™ºèƒ½åˆ‡æ¢æœºåˆ¶** (`services.py`)

   - æ ¹æ®é…ç½®è‡ªåŠ¨é€‰æ‹©çˆ¬è™«
   - `USE_AUTHENTICATED_SCRAPER=True` â†’ è®¤è¯çˆ¬è™«
   - `USE_AUTHENTICATED_SCRAPER=False` â†’ æ¸¸å®¢çˆ¬è™«

4. **ç®¡ç†å‘½ä»¤** (`setup_x_auth.py`)

   - Django å‘½ä»¤ï¼š`python manage.py setup_x_auth`
   - æ”¯æŒ Docker å’Œæœ¬åœ°è¿è¡Œ

5. **æ—¶é—´è¿‡æ»¤å’Œå»é‡** (`services.py` ä¸­çš„ `monitor_account`)

   - æ•°æ®åº“å±‚é¢è¿‡æ»¤ 6 å°æ—¶å†…æ¨æ–‡
   - tweet_id + æ—¶é—´çª—å£åŒé‡å»é‡
   - é˜²æ­¢æ—¶é—´æ¼‚ç§»å¯¼è‡´çš„é‡å¤

6. **å‰ç«¯æŒ‰é’®** (`AccountsPage.js`)
   - "æœ€æ–° 10 æ¡"æŒ‰é’®
   - API ç«¯ç‚¹ï¼š`POST /api/monitor/accounts/{id}/fetch-latest/`

### âš ï¸ å¾…æµ‹è¯•

1. è®¤è¯çˆ¬è™«çš„å®é™…æ•ˆæœ
2. Cookies çš„æœ‰æ•ˆæœŸï¼ˆé¢„è®¡ 30-90 å¤©ï¼‰
3. å¤§é‡æ¨æ–‡æƒ…å†µä¸‹çš„æ€§èƒ½

---

## å¿«é€Ÿå¼€å§‹æŒ‡å—

### ç¬¬ä¸€æ¬¡ä½¿ç”¨

```bash
# 1. è®¾ç½®è®¤è¯ï¼ˆWindowsæœ¬åœ°ï¼‰
cd backend
python local_setup_auth.py
# â†’ æµè§ˆå™¨æ‰“å¼€ï¼Œæ‰‹åŠ¨ç™»å½•X.comï¼ŒæŒ‰Enterä¿å­˜cookies

# 2. å¯ç”¨è®¤è¯çˆ¬è™«
# ç¼–è¾‘ docker-compose.ymlï¼Œåœ¨backend/celery/celery-beatçš„environmentä¸­æ·»åŠ ï¼š
#   USE_AUTHENTICATED_SCRAPER: "True"

# 3. é‡å¯æœåŠ¡
docker-compose restart

# 4. æµ‹è¯•
docker-compose exec backend python test_authenticated_scraper.py
# â†’ åº”è¯¥çœ‹åˆ°è·å–åˆ°20+æ¡æ¨æ–‡ï¼ŒåŒ…æ‹¬æœ€æ–°æ¨æ–‡

# 5. åœ¨å‰ç«¯æµ‹è¯•
# è®¿é—® http://localhost:3000
# ç™»å½•åï¼Œåœ¨è´¦æˆ·åˆ—è¡¨ç‚¹å‡»"æœ€æ–°10æ¡"æŒ‰é’®
# â†’ åº”è¯¥æ˜¾ç¤º"Xæ¡ã®æ–°ã—ã„æ¨æ–‡ã‚’å–å¾—ã—ã¾ã—ãŸ"ï¼ˆX > 0ï¼‰
```

### æ—¥å¸¸ä½¿ç”¨

Cookies ä¼šè‡ªåŠ¨é‡ç”¨ï¼Œæ— éœ€æ¯æ¬¡ç™»å½•ã€‚åªéœ€åœ¨ä»¥ä¸‹æƒ…å†µé‡æ–°è®¾ç½®ï¼š

- Cookies è¿‡æœŸï¼ˆ30-90 å¤©åï¼‰
- è´¦å·è¢«ç™»å‡º
- çˆ¬è™«è¿”å› 0 æ¡æ¨æ–‡ä¸”ç¡®è®¤æœ‰æ–°æ¨æ–‡

---

## ç¯å¢ƒå˜é‡é…ç½®

### docker-compose.yml

```yaml
services:
  backend:
    environment:
      USE_AUTHENTICATED_SCRAPER: "True" # å¯ç”¨è®¤è¯çˆ¬è™«
      # USE_AUTHENTICATED_SCRAPER: "False"  # ä½¿ç”¨æ¸¸å®¢çˆ¬è™«ï¼ˆé»˜è®¤ï¼‰
```

### settings.py

```python
USE_AUTHENTICATED_SCRAPER = config('USE_AUTHENTICATED_SCRAPER', default=False, cast=bool)
```

---

## æ–‡ä»¶ç»“æ„

```
backend/
â”œâ”€â”€ x_monitor/
â”‚   â”œâ”€â”€ authenticated_scraper.py       # è®¤è¯çˆ¬è™«å®ç° â­
â”‚   â”œâ”€â”€ services.py                     # çˆ¬è™«æœåŠ¡ï¼ˆæ™ºèƒ½é€‰æ‹©ï¼‰
â”‚   â”œâ”€â”€ management/commands/
â”‚   â”‚   â””â”€â”€ setup_x_auth.py            # Djangoç®¡ç†å‘½ä»¤
â”‚   â””â”€â”€ ...
â”œâ”€â”€ data/
â”‚   â””â”€â”€ x_cookies.json                  # ä¿å­˜çš„cookiesï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰â­
â”œâ”€â”€ local_setup_auth.py                 # Windowsæœ¬åœ°è®¤è¯è„šæœ¬ â­
â””â”€â”€ test_authenticated_scraper.py       # æµ‹è¯•è„šæœ¬ â­

AUTHENTICATED_SCRAPER_GUIDE.md          # è¯¦ç»†ä½¿ç”¨æŒ‡å— ğŸ“–
SCRAPER_SOLUTIONS_SUMMARY.md            # æœ¬æ–‡ä»¶ ğŸ“–
```

---

## æ•…éšœæ’é™¤

### é—®é¢˜ 1: è¿è¡Œ setup_x_auth æŠ¥é”™

**å¯èƒ½åŸå› **: Docker ç¯å¢ƒæ²¡æœ‰å›¾å½¢ç•Œé¢

**è§£å†³æ–¹æ¡ˆ**: ä½¿ç”¨ Windows æœ¬åœ°è„šæœ¬

```bash
cd backend
python local_setup_auth.py
```

### é—®é¢˜ 2: ä»ç„¶è¿”å› 0 æ¡æ¨æ–‡

**æ£€æŸ¥æ­¥éª¤**:

1. ç¡®è®¤ cookies æ–‡ä»¶å­˜åœ¨ï¼š`ls backend/data/x_cookies.json`
2. æ£€æŸ¥ç¯å¢ƒå˜é‡ï¼š`docker-compose exec backend env | grep AUTHENTICATED`
3. æŸ¥çœ‹æ—¥å¿—ï¼š`docker-compose logs backend | grep "authenticated"`
4. è¿è¡Œæµ‹è¯•ï¼š`docker-compose exec backend python test_authenticated_scraper.py`

å¦‚æœæµ‹è¯•å¤±è´¥ï¼Œé‡æ–°è¿è¡Œè®¤è¯è®¾ç½®ã€‚

### é—®é¢˜ 3: Cookies è¿‡æœŸ

**ç—‡çŠ¶**: ä¹‹å‰èƒ½è·å–æ¨æ–‡ï¼Œç°åœ¨åˆå˜æˆ 0 æ¡

**è§£å†³æ–¹æ¡ˆ**: é‡æ–°è¿è¡Œè®¤è¯è®¾ç½®

```bash
python backend/local_setup_auth.py
docker-compose restart
```

---

## å®‰å…¨æç¤º

âš ï¸ **é‡è¦**:

- `x_cookies.json` åŒ…å«ä½ çš„ç™»å½•å‡­è¯
- å·²åŠ å…¥ `.gitignore`ï¼Œä¸ä¼šæäº¤åˆ° Git
- ä¸è¦åˆ†äº«è¿™ä¸ªæ–‡ä»¶
- å»ºè®®ä½¿ç”¨ä¸“ç”¨è´¦å·è€Œéä¸»è´¦å·

---

## æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡         | æ¸¸å®¢æ¨¡å¼    | è®¤è¯æ¨¡å¼      |
| ------------ | ----------- | ------------- |
| å¯è§æ¨æ–‡æ•°   | 4-6 æ¡      | 20-100+æ¡     |
| æ—¶é—´çº¿å®Œæ•´æ€§ | âŒ ä»…ç½®é¡¶   | âœ… å®Œæ•´       |
| æœ€æ–°æ¨æ–‡     | âŒ æ— æ³•è·å– | âœ… å®æ—¶è·å–   |
| æ»šåŠ¨åŠ è½½     | âŒ ä¸å·¥ä½œ   | âœ… æ­£å¸¸å·¥ä½œ   |
| ç¨³å®šæ€§       | âš ï¸ æ˜“è¢«é™åˆ¶ | âœ… ç¨³å®šå¯é    |
| è®¾ç½®éš¾åº¦     | âœ… æ— éœ€è®¾ç½® | âš ï¸ éœ€ä¸€æ¬¡ç™»å½• |

---

## ä¸‹ä¸€æ­¥

1. âœ… **ç«‹å³æ‰§è¡Œ**: è¿è¡Œ `python backend/local_setup_auth.py` è®¾ç½®è®¤è¯
2. âœ… **å¯ç”¨åŠŸèƒ½**: ä¿®æ”¹ `docker-compose.yml` å¯ç”¨è®¤è¯çˆ¬è™«
3. âœ… **æµ‹è¯•éªŒè¯**: è¿è¡Œæµ‹è¯•è„šæœ¬ç¡®è®¤æ•ˆæœ
4. â­ï¸ **ç›‘æ§è¿è¡Œ**: è§‚å¯Ÿæ—¥å¿—ï¼Œç¡®ä¿ cookies æœ‰æ•ˆ
5. â­ï¸ **å®šæœŸç»´æŠ¤**: 30-90 å¤©åå¯èƒ½éœ€è¦é‡æ–°è®¾ç½®è®¤è¯

---

## è”ç³»æ”¯æŒ

å¦‚é‡é—®é¢˜ï¼Œè¯·æä¾›ï¼š

1. é”™è¯¯æ—¥å¿—ï¼š`docker-compose logs backend | tail -100`
2. ç¯å¢ƒå˜é‡ï¼š`docker-compose exec backend env | grep AUTHENTICATED`
3. æµ‹è¯•ç»“æœï¼š`docker-compose exec backend python test_authenticated_scraper.py`
4. Cookies æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼š`ls -la backend/data/`
